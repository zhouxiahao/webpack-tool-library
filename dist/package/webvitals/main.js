/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["webvitals"] = factory();
	else
		root["webvitals"] = factory();
})(self, () => {
return /******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/package/webvitals/http/proxy-fetch.ts":
/*!***************************************************!*\
  !*** ./src/package/webvitals/http/proxy-fetch.ts ***!
  \***************************************************/
/***/ (function(__unused_webpack_module, exports) {

eval("\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function sent() {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (g && (g = 0, op[0] && (_ = 0)), _) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.proxyFetch = void 0;\nvar proxyFetch = function proxyFetch(sendHandler, loadHandler) {\n  if ('fetch' in window && typeof window.fetch === 'function') {\n    var oFetch_1 = window.fetch;\n    if (!window.oFetch) {\n      window.oFetch = oFetch_1;\n    }\n    window.fetch = function (input, init) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var metrics;\n        return __generator(this, function (_a) {\n          if (typeof sendHandler === 'function') sendHandler(init);\n          metrics = {};\n          metrics.method = (init === null || init === void 0 ? void 0 : init.method) || '';\n          metrics.url = (input && typeof input !== 'string' ? input === null || input === void 0 ? void 0 : input.url : input) || '';\n          metrics.body = (init === null || init === void 0 ? void 0 : init.body) || '';\n          metrics.requestTime = new Date().getTime();\n          return [2 /*return*/, oFetch_1.call(window, input, init).then(function (response) {\n            return __awaiter(void 0, void 0, void 0, function () {\n              var res, _a;\n              var _b;\n              return __generator(this, function (_c) {\n                switch (_c.label) {\n                  case 0:\n                    res = response.clone();\n                    _a = [__assign({}, metrics)];\n                    _b = {\n                      status: res.status,\n                      statusText: res.statusText\n                    };\n                    return [4 /*yield*/, res.text()];\n                  case 1:\n                    metrics = __assign.apply(void 0, _a.concat([(_b.response = _c.sent(), _b.responseTime = new Date().getTime(), _b)]));\n                    if (typeof loadHandler === 'function') loadHandler(metrics);\n                    return [2 /*return*/, response];\n                }\n              });\n            });\n          })];\n        });\n      });\n    };\n  }\n};\nexports.proxyFetch = proxyFetch;\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/http/proxy-fetch.ts?");

/***/ }),

/***/ "./src/package/webvitals/http/proxy-xml-http.ts":
/*!******************************************************!*\
  !*** ./src/package/webvitals/http/proxy-xml-http.ts ***!
  \******************************************************/
/***/ (function(__unused_webpack_module, exports) {

eval("\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.proxyXmlHttp = void 0;\nvar proxyXmlHttp = function proxyXmlHttp(sendHandler, loadHandler) {\n  if ('XMLHttpRequest' in window && typeof window.XMLHttpRequest === 'function') {\n    var oXMLHttpRequest_1 = window.XMLHttpRequest;\n    if (!window.oXMLHttpRequest) {\n      // oXMLHttpRequest 为原生的 XMLHttpRequest，可以用以 SDK 进行数据上报，区分业务\n      window.oXMLHttpRequest = oXMLHttpRequest_1;\n    }\n    window.XMLHttpRequest = function () {\n      var xhr = new oXMLHttpRequest_1();\n      var open = xhr.open,\n        send = xhr.send;\n      var metrics = {};\n      xhr.open = function (method, url) {\n        metrics.method = method;\n        metrics.url = url;\n        open.call(xhr, method, url, true);\n      };\n      xhr.send = function (body) {\n        metrics.body = body || '';\n        metrics.requestTime = new Date().getTime();\n        if (typeof sendHandler === 'function') sendHandler(xhr);\n        send.call(xhr, body);\n      };\n      xhr.addEventListener('loadend', function () {\n        var status = xhr.status,\n          statusText = xhr.statusText,\n          response = xhr.response;\n        metrics = __assign(__assign({}, metrics), {\n          status: status,\n          statusText: statusText,\n          response: response,\n          responseTime: new Date().getTime()\n        });\n        if (typeof loadHandler === 'function') loadHandler(metrics);\n      });\n      return xhr;\n    };\n  }\n};\nexports.proxyXmlHttp = proxyXmlHttp;\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/http/proxy-xml-http.ts?");

/***/ }),

/***/ "./src/package/webvitals/index.ts":
/*!****************************************!*\
  !*** ./src/package/webvitals/index.ts ***!
  \****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nvar web_1 = __importDefault(__webpack_require__(/*! ./web */ \"./src/package/webvitals/web/index.ts\"));\nvar user_action_1 = __importDefault(__webpack_require__(/*! ./user-action */ \"./src/package/webvitals/user-action/index.ts\"));\nexports[\"default\"] = {\n  WebVitals: web_1[\"default\"],\n  UserVitals: user_action_1[\"default\"]\n};\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/index.ts?");

/***/ }),

/***/ "./src/package/webvitals/user-action/behavior-store.ts":
/*!*************************************************************!*\
  !*** ./src/package/webvitals/user-action/behavior-store.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\n// 暂存用户的行为记录追踪\nvar behaviorStore = /** @class */function () {\n  function behaviorStore(options) {\n    var maxBehaviorRecords = options.maxBehaviorRecords;\n    this.maxBehaviorRecords = maxBehaviorRecords;\n    this.state = [];\n  }\n  behaviorStore.prototype.push = function (value) {\n    if (this.length() === this.maxBehaviorRecords) {\n      this.shift();\n    }\n    this.state.push(value);\n  };\n  behaviorStore.prototype.shift = function () {\n    return this.state.shift();\n  };\n  behaviorStore.prototype.get = function () {\n    return this.state;\n  };\n  behaviorStore.prototype.clear = function () {\n    this.state = [];\n  };\n  behaviorStore.prototype.length = function () {\n    return this.state.length;\n  };\n  return behaviorStore;\n}();\nexports[\"default\"] = behaviorStore;\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/user-action/behavior-store.ts?");

/***/ }),

/***/ "./src/package/webvitals/user-action/get-page-info.ts":
/*!************************************************************!*\
  !*** ./src/package/webvitals/user-action/get-page-info.ts ***!
  \************************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.getOriginInfo = exports.getExtends = void 0;\nvar getPageInfo = function getPageInfo() {\n  var _a = window.location,\n    host = _a.host,\n    hostname = _a.hostname,\n    href = _a.href,\n    protocol = _a.protocol,\n    origin = _a.origin,\n    port = _a.port,\n    pathname = _a.pathname,\n    search = _a.search,\n    hash = _a.hash;\n  var _b = window.screen,\n    width = _b.width,\n    height = _b.height;\n  var language = navigator.language,\n    userAgent = navigator.userAgent;\n  return {\n    host: host,\n    hostname: hostname,\n    href: href,\n    protocol: protocol,\n    origin: origin,\n    port: port,\n    pathname: pathname,\n    search: search,\n    hash: hash,\n    title: document.title,\n    language: language.substr(0, 2),\n    userAgent: userAgent,\n    winScreen: \"\".concat(width, \"x\").concat(height),\n    docScreen: \"\".concat(document.documentElement.clientWidth || document.body.clientWidth, \"x\").concat(document.documentElement.clientHeight || document.body.clientHeight)\n  };\n};\nvar getExtends = function getExtends() {\n  return {\n    page: getPageInfo().pathname,\n    timestamp: new Date().getTime()\n  };\n};\nexports.getExtends = getExtends;\nvar getOriginInfo = function getOriginInfo() {\n  return {\n    referrer: document.referrer,\n    type: performance.getEntriesByType('navigation')[0].type\n  };\n};\nexports.getOriginInfo = getOriginInfo;\nexports[\"default\"] = getPageInfo;\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/user-action/get-page-info.ts?");

/***/ }),

/***/ "./src/package/webvitals/user-action/get-router-change.ts":
/*!****************************************************************!*\
  !*** ./src/package/webvitals/user-action/get-router-change.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.proxyHash = exports.proxyHistory = exports.wrHistory = void 0;\nvar wr = function wr(type) {\n  var orig = history[type];\n  return function () {\n    var rv = orig.apply(this, arguments);\n    var e = new Event(type);\n    window.dispatchEvent(e);\n    return rv;\n  };\n};\nvar wrHistory = function wrHistory() {\n  history.pushState = wr('pushState');\n  history.replaceState = wr('replaceState');\n};\nexports.wrHistory = wrHistory;\nvar proxyHistory = function proxyHistory(handler) {\n  // 添加对replaceState的监听\n  window.addEventListener('replaceState', function (e) {\n    return handler(e);\n  }, true);\n  // 添加对 pushState 的监听\n  window.addEventListener('pushState', function (e) {\n    return handler(e);\n  }, true);\n};\nexports.proxyHistory = proxyHistory;\nvar proxyHash = function proxyHash(handler) {\n  window.addEventListener('hashchange', function (e) {\n    return handler(e);\n  });\n  window.addEventListener('popstate', function (e) {\n    return handler(e);\n  });\n};\nexports.proxyHash = proxyHash;\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/user-action/get-router-change.ts?");

/***/ }),

/***/ "./src/package/webvitals/user-action/index.ts":
/*!****************************************************!*\
  !*** ./src/package/webvitals/user-action/index.ts ***!
  \****************************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nvar store_1 = __importStar(__webpack_require__(/*! ./store */ \"./src/package/webvitals/user-action/store.ts\"));\nvar behavior_store_1 = __importDefault(__webpack_require__(/*! ./behavior-store */ \"./src/package/webvitals/user-action/behavior-store.ts\"));\nvar get_page_info_1 = __importStar(__webpack_require__(/*! ./get-page-info */ \"./src/package/webvitals/user-action/get-page-info.ts\"));\nvar get_router_change_1 = __webpack_require__(/*! ./get-router-change */ \"./src/package/webvitals/user-action/get-router-change.ts\");\nvar web_api_1 = __webpack_require__(/*! ../utils/web-api */ \"./src/package/webvitals/utils/web-api.ts\");\nvar proxy_xml_http_1 = __webpack_require__(/*! ../http/proxy-xml-http */ \"./src/package/webvitals/http/proxy-xml-http.ts\");\nvar proxy_fetch_1 = __webpack_require__(/*! ../http/proxy-fetch */ \"./src/package/webvitals/http/proxy-fetch.ts\");\nvar UserVitals = /** @class */function () {\n  // constructor(engineInstance: EngineInstance) {\n  function UserVitals(options) {\n    var _this = this;\n    if (options === void 0) {\n      options = {\n        maxBehaviorRecords: 100\n      };\n    }\n    this.initCustomerHandler = function () {\n      var handler = function handler(options) {\n        _this.metrics.add(store_1.metricsName.CDR, options);\n        _this.userSendHandler(options);\n        _this.breadcrumbs.push(__assign({\n          category: store_1.metricsName.CDR,\n          data: options\n        }, (0, get_page_info_1.getExtends)()));\n      };\n      return handler;\n    };\n    this.initPageInfo = function () {\n      var info = (0, get_page_info_1[\"default\"])();\n      var metrics = info;\n      _this.metrics.set(store_1.metricsName.PI, metrics);\n    };\n    // 检测路由改变\n    this.initRouterChange = function () {\n      var handler = function handler(e) {\n        var metrics = {\n          jumpType: e.type,\n          timestamp: new Date().getTime(),\n          pageInfo: (0, get_page_info_1[\"default\"])()\n        };\n        // 看情况上报页面跳转的信息\n        _this.metrics.add(store_1.metricsName.RCR, metrics);\n        delete metrics.pageInfo;\n        // 行为记录追踪\n        var behavior = __assign({\n          category: store_1.metricsName.RCR,\n          data: metrics\n        }, (0, get_page_info_1.getExtends)());\n        _this.breadcrumbs.push(behavior);\n        (0, get_router_change_1.proxyHash)(handler);\n        (0, get_router_change_1.proxyHistory)(handler);\n      };\n    };\n    this.initPV = function () {\n      var handler = function handler() {\n        var metrics = {\n          timestamp: new Date().getTime(),\n          pageInfo: (0, get_page_info_1[\"default\"])(),\n          originInformation: (0, get_page_info_1.getOriginInfo)()\n        };\n        _this.userSendHandler(metrics);\n      };\n      (0, web_api_1.afterLoad)(function () {\n        handler();\n      });\n    };\n    this.initOriginInfo = function () {\n      var info = (0, get_page_info_1.getOriginInfo)();\n      var metrics = info;\n      _this.metrics.set(store_1.metricsName.OI, metrics);\n    };\n    this.initClickHandler = function (mountList) {\n      // TODO: 不够完善，特定ID的button按钮点击上报功能\n      var handler = function handler(e) {\n        var _a, _b;\n        debugger;\n        var target = (_a = e.path) === null || _a === void 0 ? void 0 : _a.find(function (x) {\n          var _a;\n          return mountList.includes((_a = x.tagName) === null || _a === void 0 ? void 0 : _a.toLowerCase());\n        });\n        target = target || (mountList.includes((_b = e.target.tagName) === null || _b === void 0 ? void 0 : _b.toLowerCase()) ? e.target : undefined);\n        if (!target) return;\n        var metrics = {\n          tagInfo: {\n            id: target.id,\n            classList: Array.from(target.classList),\n            tagName: target.tagName,\n            text: target.textContent\n          },\n          timestamp: new Date().getTime(),\n          pageInfo: (0, get_page_info_1[\"default\"])()\n        };\n        _this.metrics.add(store_1.metricsName.CBR, metrics);\n        delete metrics.pageInfo;\n        // 行为记录追踪\n        var behavior = __assign({\n          category: store_1.metricsName.CBR,\n          data: metrics\n        }, (0, get_page_info_1.getExtends)());\n        _this.breadcrumbs.push(behavior);\n      };\n      window.addEventListener('click', function (e) {\n        console.log('上报');\n        handler(e);\n      }, true);\n    };\n    this.initHttpHandler = function () {\n      var loadHandler = function loadHandler(metrics) {\n        if (metrics.status < 400) {\n          // 过滤正常请求的 请求体 和 响应体\n          delete metrics.response;\n          delete metrics.body;\n        }\n        _this.metrics.add(store_1.metricsName.HT, metrics);\n        _this.breadcrumbs.push(__assign({\n          category: store_1.metricsName.HT,\n          data: metrics\n        }, (0, get_page_info_1.getExtends)()));\n      };\n      (0, proxy_xml_http_1.proxyXmlHttp)(null, loadHandler);\n      (0, proxy_fetch_1.proxyFetch)(null, loadHandler);\n    };\n    // this.engineInstance = engineInstance;\n    var maxBehaviorRecords = options.maxBehaviorRecords;\n    this.metrics = new store_1[\"default\"]();\n    this.maxBehaviorRecords = maxBehaviorRecords;\n    // 初始化行为追踪记录\n    this.breadcrumbs = new behavior_store_1[\"default\"]({\n      maxBehaviorRecords: maxBehaviorRecords\n    });\n    // 初始化用户自定义事件捕获\n    this.customHandler = this.initCustomerHandler();\n    this.clickMountList = ['button'].map(function (x) {\n      return x.toLowerCase();\n    });\n    // 重写事件\n    (0, get_router_change_1.wrHistory)();\n    this.initPageInfo();\n    // 初始化路由跳转获取\n    this.initRouterChange();\n    this.initOriginInfo();\n    this.initPV();\n    this.initClickHandler(this.clickMountList);\n    this.initHttpHandler();\n  }\n  // 上报入口\n  UserVitals.prototype.userSendHandler = function (data) {};\n  return UserVitals;\n}();\nexports[\"default\"] = UserVitals;\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/user-action/index.ts?");

/***/ }),

/***/ "./src/package/webvitals/user-action/store.ts":
/*!****************************************************!*\
  !*** ./src/package/webvitals/user-action/store.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.metricsName = void 0;\nvar metricsName;\n(function (metricsName) {\n  metricsName[\"PI\"] = \"page-information\";\n  metricsName[\"OI\"] = \"origin-information\";\n  metricsName[\"RCR\"] = \"router-change-record\";\n  metricsName[\"CBR\"] = \"click-behavior-record\";\n  metricsName[\"CDR\"] = \"custom-define-record\";\n  metricsName[\"HT\"] = \"http-record\";\n})(metricsName || (exports.metricsName = metricsName = {}));\nvar userMetricsStore = /** @class */function () {\n  function userMetricsStore() {\n    this.state = new Map();\n  }\n  userMetricsStore.prototype.set = function (key, value) {\n    this.state.set(key, value);\n  };\n  userMetricsStore.prototype.add = function (key, value) {\n    var keyValue = this.state.get(key);\n    this.state.set(key, keyValue ? keyValue.concat([value]) : [value]);\n  };\n  userMetricsStore.prototype.get = function (key) {\n    return this.state.get(key);\n  };\n  userMetricsStore.prototype.has = function (key) {\n    return this.state.has(key);\n  };\n  userMetricsStore.prototype.clear = function () {\n    this.state.clear();\n  };\n  userMetricsStore.prototype.getValues = function () {\n    // Map => 对象\n    return Object.fromEntries(this.state);\n  };\n  return userMetricsStore;\n}();\nexports[\"default\"] = userMetricsStore;\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/user-action/store.ts?");

/***/ }),

/***/ "./src/package/webvitals/utils/web-api.ts":
/*!************************************************!*\
  !*** ./src/package/webvitals/utils/web-api.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.afterLoad = void 0;\nvar afterLoad = function afterLoad(callback) {\n  // NOTE: document有readyState属性来描述document的loading状态，readyState的改变会触发readystatechange事件.\n  // loading\n  // 文档仍然在加载\n  // interactive\n  // 文档结束加载并且被解析，但是像图片，样式，frame之类的子资源仍在加载\n  // complete\n  // 文档和子资源已经结束加载，该状态表明将要触发load事件。\n  if (document.readyState === 'complete') {\n    setTimeout(callback);\n  } else {\n    window.addEventListener('pageshow', callback, {\n      once: true,\n      capture: true\n    });\n  }\n};\nexports.afterLoad = afterLoad;\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/utils/web-api.ts?");

/***/ }),

/***/ "./src/package/webvitals/web/index.ts":
/*!********************************************!*\
  !*** ./src/package/webvitals/web/index.ts ***!
  \********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.getResourceFlow = exports.getCLS = exports.getFID = exports.getLCP = exports.getFCP = exports.getFP = exports.observe = void 0;\nvar store_1 = __importStar(__webpack_require__(/*! ./store */ \"./src/package/webvitals/web/store.ts\"));\nvar web_api_1 = __webpack_require__(/*! ../utils/web-api */ \"./src/package/webvitals/utils/web-api.ts\");\nvar observe = function observe(type, callback) {\n  var _a;\n  // PerformanceObserver.supportedEntryTypes:\n  // returns [\"element\", \"event\", \"first-input\", \"largest-contentful-paint\", \"layout-shift\", \"longtask\", \"mark\", \"measure\", \"navigation\", \"paint\", \"resource\"] in Chrome 89\n  if ((_a = PerformanceObserver.supportedEntryTypes) === null || _a === void 0 ? void 0 : _a.includes(type)) {\n    var ob = new PerformanceObserver(function (l) {\n      return l.getEntries().map(callback);\n    });\n    ob.observe({\n      type: type,\n      buffered: true\n    });\n    return ob;\n  }\n  return undefined;\n};\nexports.observe = observe;\nvar getFP = function getFP() {\n  var entry = performance.getEntriesByName('first-paint')[0];\n  return entry;\n};\nexports.getFP = getFP;\nvar getFCP = function getFCP() {\n  var entry = performance.getEntriesByName('first-contentful-paint')[0];\n  return entry;\n};\nexports.getFCP = getFCP;\nvar getLCP = function getLCP(entryHandler) {\n  return (0, exports.observe)('largest-contentful-paint', entryHandler);\n};\nexports.getLCP = getLCP;\n// 获取 FID\nvar getFID = function getFID(entryHandler) {\n  return (0, exports.observe)('first-input', entryHandler);\n};\nexports.getFID = getFID;\n// 获取 CLS\nvar getCLS = function getCLS(entryHandler) {\n  return (0, exports.observe)('layout-shift', entryHandler);\n};\nexports.getCLS = getCLS;\n// 获取NT\nvar getNavigationTiming = function getNavigationTiming() {\n  var resolveNavigationTiming = function resolveNavigationTiming(entry) {\n    var domainLookupStart = entry.domainLookupStart,\n      domainLookupEnd = entry.domainLookupEnd,\n      connectStart = entry.connectStart,\n      connectEnd = entry.connectEnd,\n      secureConnectionStart = entry.secureConnectionStart,\n      requestStart = entry.requestStart,\n      responseStart = entry.responseStart,\n      responseEnd = entry.responseEnd,\n      domInteractive = entry.domInteractive,\n      domContentLoadedEventEnd = entry.domContentLoadedEventEnd,\n      loadEventStart = entry.loadEventStart,\n      fetchStart = entry.fetchStart;\n    return {\n      FP: responseEnd - fetchStart,\n      TTI: domInteractive - fetchStart,\n      DomReady: domContentLoadedEventEnd - fetchStart,\n      Load: loadEventStart - fetchStart,\n      FirstByte: responseStart - domainLookupStart,\n      DNS: domainLookupEnd - domainLookupStart,\n      TCP: connectEnd - connectStart,\n      SSL: secureConnectionStart ? connectEnd - secureConnectionStart : 0,\n      TTFB: responseStart - requestStart,\n      Trans: responseEnd - responseStart,\n      DomParse: domInteractive - responseEnd,\n      Res: loadEventStart - domContentLoadedEventEnd\n    };\n  };\n  var navigation =\n  // W3C Level2  PerformanceNavigationTiming\n  // 使用了High-Resolution Time，时间精度可以达毫秒的小数点好几位。\n  performance.getEntriesByType('navigation').length > 0 ? performance.getEntriesByType('navigation')[0] : performance.timing; // W3C Level1  (目前兼容性高，仍然可使用，未来可能被废弃)。\n  return resolveNavigationTiming(navigation);\n};\nvar getResourceFlow = function getResourceFlow(resourceFlow) {\n  var entryHandler = function entryHandler(entry) {\n    var name = entry.name,\n      transferSize = entry.transferSize,\n      initiatorType = entry.initiatorType,\n      startTime = entry.startTime,\n      responseEnd = entry.responseEnd,\n      domainLookupEnd = entry.domainLookupEnd,\n      domainLookupStart = entry.domainLookupStart,\n      connectStart = entry.connectStart,\n      connectEnd = entry.connectEnd,\n      secureConnectionStart = entry.secureConnectionStart,\n      responseStart = entry.responseStart,\n      requestStart = entry.requestStart;\n    resourceFlow.push({\n      // name 资源地址\n      name: name,\n      // transferSize 传输大小\n      transferSize: transferSize,\n      // initiatorType 资源类型\n      initiatorType: initiatorType,\n      // startTime 开始时间\n      startTime: startTime,\n      // responseEnd 结束时间\n      responseEnd: responseEnd,\n      // 贴近 Chrome 的近似分析方案，受到跨域资源影响\n      dnsLookup: domainLookupEnd - domainLookupStart,\n      initialConnect: connectEnd - connectStart,\n      ssl: connectEnd - secureConnectionStart,\n      request: responseStart - requestStart,\n      ttfb: responseStart - requestStart,\n      contentDownload: responseStart - requestStart\n    });\n  };\n  return (0, exports.observe)('resource', entryHandler);\n};\nexports.getResourceFlow = getResourceFlow;\nvar WebVitals = /** @class */function () {\n  function WebVitals(engineInstance) {\n    var _this = this;\n    // 初始化 FP 的获取以及返回\n    this.initFP = function () {\n      var entry = (0, exports.getFP)();\n      var metrics = {\n        startTime: entry === null || entry === void 0 ? void 0 : entry.startTime.toFixed(2),\n        entry: entry\n      };\n      _this.metrics.set(store_1.metricsName.FP, metrics);\n    };\n    this.initFCP = function () {\n      var entry = (0, exports.getFCP)();\n      var metrics = {\n        startTime: entry === null || entry === void 0 ? void 0 : entry.startTime.toFixed(2),\n        entry: entry\n      };\n      _this.metrics.set(store_1.metricsName.FCP, metrics);\n    };\n    this.initLCP = function () {\n      var entryHandler = function entryHandler(entry) {\n        var metrics = {\n          startTime: entry === null || entry === void 0 ? void 0 : entry.startTime.toFixed(2),\n          entry: entry\n        };\n        _this.metrics.set(store_1.metricsName.LCP, metrics);\n      };\n      (0, exports.getLCP)(entryHandler);\n    };\n    this.initFID = function () {\n      var entryHandler = function entryHandler(entry) {\n        var metrics = {\n          delay: entry.processingStart - entry.startTime,\n          entry: entry\n        };\n        _this.metrics.set(store_1.metricsName.FID, metrics);\n      };\n      (0, exports.getFID)(entryHandler);\n    };\n    this.initCLS = function () {\n      var clsValue = 0;\n      var clsEntries = [];\n      var sessionValue = 0;\n      var sessionEntries = [];\n      var entryHandler = function entryHandler(entry) {\n        // NOTE: entry.value: 布局偏移分数，计算方式为影响分数（已移动的视口的分数）乘以距离分数（作为视口的分数移动的距离）。\n        if (!entry.hadRecentInput) {\n          // NOTE: 如果 lastInputTime 过去小于 500 毫秒，则返回 true 。\n          // NOTE: 返回最近排除输入的时间（用户输入将排除此条目作为 CLS 分数的贡献者），或者 0 如果未发生排除输入。\n          var firstSessionEntry = sessionEntries[0];\n          var lastSessionEntry = sessionEntries[sessionEntries.length - 1];\n          if (sessionValue && entry.startTime - lastSessionEntry.startTime < 1000 && entry.startTime - firstSessionEntry.startTime < 5000) {\n            sessionValue += entry.value;\n            sessionEntries.push(entry);\n          } else {\n            sessionValue = entry.value;\n            sessionEntries = [entry];\n          }\n          // 如果当前会话值大于当前CLS值，那么更新CLS及其相关条目\n          if (sessionValue > clsValue) {\n            clsValue = sessionValue;\n            clsEntries = sessionEntries;\n            // 记录CLS到Map里\n            var metrics = {\n              entry: entry,\n              clsValue: clsValue,\n              clsEntries: clsEntries\n            };\n            _this.metrics.set(store_1.metricsName.CLS, metrics);\n          }\n        }\n      };\n      (0, exports.getCLS)(entryHandler);\n    };\n    this.initNavigationTiming = function () {\n      var navigationTiming = getNavigationTiming();\n      var metrics = navigationTiming;\n      _this.metrics.set(store_1.metricsName.NT, metrics);\n    };\n    this.initResourceFlow = function () {\n      var resourceFlow = [];\n      var resObserve = (0, exports.getResourceFlow)(resourceFlow);\n      var stopListening = function stopListening() {\n        if (resObserve) {\n          resObserve.disconnect();\n        }\n        var metrics = resourceFlow;\n        _this.metrics.set(store_1.metricsName.RF, metrics);\n      };\n      // 当一条会话历史记录被执行的时候将会触发页面显示 (pageshow) 事件。(这包括了后退/前进按钮操作，同时也会在 onload 事件触发后初始化页面时触发)\n      window.addEventListener('pageshow', stopListening, {\n        once: true,\n        capture: true\n      });\n    };\n    this.engineInstance = engineInstance;\n    this.metrics = new store_1[\"default\"]();\n    this.initLCP();\n    this.initCLS();\n    // this.initResourceFlow();\n    (0, web_api_1.afterLoad)(function () {\n      _this.initNavigationTiming();\n      _this.initFP();\n      _this.initFCP();\n      _this.initFID();\n    });\n  }\n  return WebVitals;\n}();\nexports[\"default\"] = WebVitals;\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/web/index.ts?");

/***/ }),

/***/ "./src/package/webvitals/web/store.ts":
/*!********************************************!*\
  !*** ./src/package/webvitals/web/store.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.metricsName = void 0;\nvar metricsName;\n(function (metricsName) {\n  // web\n  metricsName[\"FP\"] = \"first-paint\";\n  metricsName[\"FCP\"] = \"first-contentful-paint\";\n  metricsName[\"LCP\"] = \"largest-contentful-paint\";\n  metricsName[\"FID\"] = \"first-input-delay\";\n  metricsName[\"CLS\"] = \"cumulative-layout-shift\";\n  metricsName[\"NT\"] = \"navigation-timing\";\n  metricsName[\"RF\"] = \"resource-flow\";\n  // user\n  metricsName[\"PI\"] = \"page-information\";\n  metricsName[\"OI\"] = \"origin-information\";\n  metricsName[\"RCR\"] = \"router-change-record\";\n  metricsName[\"CBR\"] = \"click-behavior-record\";\n  metricsName[\"CDR\"] = \"custom-define-record\";\n  metricsName[\"HT\"] = \"http-record\";\n})(metricsName || (exports.metricsName = metricsName = {}));\n// Map 数据暂存\nvar metricsStore = /** @class */function () {\n  function metricsStore() {\n    this.state = new Map();\n  }\n  metricsStore.prototype.set = function (key, value) {\n    this.state.set(key, value);\n  };\n  metricsStore.prototype.add = function (key, value) {\n    var keyValue = this.state.get(key);\n    this.state.set(key, keyValue ? keyValue.concat([value]) : [value]);\n  };\n  metricsStore.prototype.get = function (key) {\n    return this.state.get(key);\n  };\n  metricsStore.prototype.has = function (key) {\n    return this.state.has(key);\n  };\n  metricsStore.prototype.clear = function () {\n    this.state.clear();\n  };\n  metricsStore.prototype.getValues = function () {\n    // Map => 对象\n    return Object.fromEntries(this.state);\n  };\n  return metricsStore;\n}();\nexports[\"default\"] = metricsStore;\n\n//# sourceURL=webpack://webvitals/./src/package/webvitals/web/store.ts?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./src/package/webvitals/index.ts");
/******/ 	__webpack_exports__ = __webpack_exports__["default"];
/******/ 	
/******/ 	return __webpack_exports__;
/******/ })()
;
});